<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.thisteam.muhansangsa.mapper.EmployeesMapper">
<!-- ===================================================================================================== -->
	<!-- ===================================== 사원 조회 시작===================================== -->
	<select id="selectMemberList" resultType="com.thisteam.muhansangsa.vo.Emp_viewVO">
		<!-- 사원조회 -->
		SELECT	IDX
				,EMP_NUM
				,EMP_NAME
				,DEPT_NAME
				,GRADE_NAME
				,EMP_TEL
				,EMP_DTEL
				,EMP_EMAIL
				,EMP_POST_NO
				,EMP_ADDR
				,HIRE_DATE
				,WORK_TYPE
				,PRIV_TYPE
				,PHOTO
		 FROM emp_view
	 		<if test="!keyword.equals('')">
			WHERE
			<!-- 2. 검색타입(searchType) 에 따른 WHERE 대상 변경 -->
			<!-- => 조건이 복수개이므로 choose 태그 사용 -->
			<choose>
				<when test="searchType.equals('emp_name')">
					EMP_NAME LIKE '%${keyword}%'
				</when>
				<when test="searchType.equals('emp_num')">
					EMP_NUM LIKE '%${keyword}%'
				</when>
				<when test="searchType.equals('emp_email')">
					EMP_EMAIL LIKE '%${keyword}%'
				</when>
				<when test="searchType.equals('dep_name')">
					DEPT_NAME LIKE '%${keyword}%'
				</when>
			</choose>		
			</if>
		
	</select>
		
	<!-- 권한 조회 -->
	<select id="getPrivilege" resultType="String">
		SELECT PRIV_CD
		FROM employees
			WHERE EMP_EMAIL = #{id}
	</select>
	
	<!-- 사원 정보 수정 -->
	<update id="updateMember">
		UPDATE	employees 
			SET IDX = #{idx}
				,EMP_NUM = #{emp_num}
				,EMP_NAME = #{emp_name}
				,DEPT_CD = #{dept_cd}
				,GRADE_CD = #{grade_cd}
				,EMP_TEL = #{emp_tel}
				,EMP_DTEL = #{emp_dtel}
				,EMP_EMAIL = #{emp_email}
				,EMP_PASSWD = #{emp_passwd}
				,EMP_POST_NO = #{emp_post_no}
				,EMP_ADDR = #{emp_addr}
				,HIRE_DATE = #{hire_date}
				,WORK_CD = #{work_cd}
				,PRIV_CD = #{priv_cd}
				,PHOTO = #{photo}
			WHERE EMP_EMAIL = #{emp_email}
	
	</update>
	
	<!-- 사원 상세조회 -->
	<select id="selectEmployee" resultType="com.thisteam.muhansangsa.vo.Emp_viewVO">
		SELECT *
		FROM emp_view
			WHERE EMP_EMAIL = #{emp_email}
		
	</select>
	<!-- ===================================== 사원 조회 끝===================================== -->
	<!-- ===================================================================================================== -->

</mapper>
